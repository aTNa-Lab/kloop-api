(this["webpackJsonpkloop-api"]=this["webpackJsonpkloop-api"]||[]).push([[0],{349:function(e,t,n){e.exports=n(668)},354:function(e,t,n){},664:function(e,t,n){},665:function(e){e.exports=JSON.parse("{}")},668:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),c=n.n(o),l=(n(354),n(282)),i=n(42),s=n.n(i),u=n(133),m=n(29),d=n(281),p={flex:1,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:"30px",paddingBottom:"30px",paddingLeft:"auto",paddingRight:"auto",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},f=function(e){var t=Object(a.useCallback)((function(t){t.forEach((function(t){e.handleChange(t),e.handleClick()}))}),[]),n=Object(d.a)({onDrop:t,noClick:!0,noKeyboard:!0,multiple:!0}),o=(n.acceptedFiles,n.getRootProps),c=n.getInputProps,l=n.open;return r.a.createElement("section",{className:"container",style:{width:"100%"}},r.a.createElement("div",o({style:p}),r.a.createElement("input",c()),r.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"),r.a.createElement("button",{type:"button",onClick:l},"Open File Dialog")))},g=n(703),b=function(e){return r.a.createElement(g.a,{onChange:e.handleChange,value:e.value,label:"Embedding",placeholder:"Enter your embedding",variant:"outlined",rowsMin:9,rowsMax:9,style:{width:"100%",height:"100%"}})},h=n(713),E=n(714),O=n(704),j=n(275),v=n.n(j),y=function(e){return console.log("GOT",e),r.a.createElement("div",null,r.a.createElement(v.a,{option:{tooltip:{trigger:"axis"},xAxis:{data:e.timeRange},yAxis:{splitLine:{show:!1}},toolbox:{left:"center",feature:{dataZoom:{yAxisIndex:"none"},restore:{},saveAsImage:{}}},dataZoom:[{type:"inside"}],series:{type:"line",data:e.dates}}}))},k=n(710),w=n(707),x=n(709),S=Object(O.a)((function(e){return{images:{},gridList:{transform:"translateZ(0)",padding:20},header:{marginBottom:0}}})),C=function(e){var t=S(),n=e.closest.map((function(e,t){return r.a.createElement(w.a,{key:t,style:{width:375}},r.a.createElement("img",{src:e.image,alt:t}),r.a.createElement(x.a,{title:e.metadata.distance}))})),a=e.farest.map((function(e,t){return r.a.createElement(w.a,{key:t,style:{width:375}},r.a.createElement("img",{src:e.image,alt:t}),r.a.createElement(x.a,{title:e.metadata.distance}))}));return r.a.createElement("div",null,r.a.createElement("h2",{className:t.header},"Closest"),r.a.createElement(k.a,{className:t.gridList,cols:e.quantity||1,cellHeight:300},n),r.a.createElement("h2",{className:t.header},"Farthest"),r.a.createElement(k.a,{className:t.gridList,cols:e.quantity||1,cellHeight:300},a))},D=(n(664),n(43)),N=n(170),R=(n(665),n(712)),T=n(717),_=n(715),I=n(280),L=n.n(I);function M(e){return r.a.createElement("div",null,r.a.createElement(T.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:e.open,autoHideDuration:6e3,onClose:e.handleClose,message:"File loaded",action:r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{size:"small","aria-label":"close",color:"inherit",onClick:e.handleClose},r.a.createElement(L.a,{fontSize:"small"})))}))}var F=Object(O.a)((function(e){return{root:{flexGrow:1,overflow:"hidden",padding:e.spacing(0,3)},gridItem:{padding:e.spacing(1),width:"50%"},spinner:{color:"grey",right:0,top:0,margin:"15px",position:"absolute"}}}));var U=function(){var e=F(),t=Object(a.useState)(""),n=Object(m.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(null),d=Object(m.a)(i,2),p=d[0],g=d[1],O=Object(a.useState)(null),j=Object(m.a)(O,2),v=(j[0],j[1]),k=Object(a.useState)(null),w=Object(m.a)(k,2),x=(w[0],w[1]),S=Object(a.useState)([]),T=Object(m.a)(S,2),_=T[0],I=T[1],L=Object(a.useState)([]),U=Object(m.a)(L,2),A=U[0],z=U[1],G=Object(a.useState)(!1),J=Object(m.a)(G,2),P=J[0],Z=J[1],B=Object(a.useState)(3),H=Object(m.a)(B,2),V=H[0],q=(H[1],Object(a.useState)(!1)),K=Object(m.a)(q,2),W=K[0],X=K[1],Y=Object(a.useState)(null),$=Object(m.a)(Y,2),Q=$[0],ee=$[1],te=Object(a.useState)(null),ne=Object(m.a)(te,2),ae=ne[0],re=ne[1],oe=Object(a.useState)(!1),ce=Object(m.a)(oe,2),le=ce[0],ie=ce[1],se=Object(a.useState)(.93),ue=Object(m.a)(se,2),me=ue[0],de=ue[1],pe=r.a.useState(!1),fe=Object(m.a)(pe,2),ge=fe[0],be=fe[1],he=function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p){e.next=3;break}return alert("No file to upload"),e.abrupt("return",0);case 3:return X(!0),console.log("Sending data"),(t=new FormData).append("token","TDlRJi8ORMGVrMedVkZDXsUDK"),t.append("action","faiss_search"),t.append("table_name","lukoshko_with_arr_norm"),t.append("index_filename","ktrk_index.faiss"),t.append("radius",me),t.append("file1",p,"image.jpg"),e.prev=12,e.next=15,fetch("https://9e94093f8750.sn.mynetname.net:5000/",{method:"POST",body:t});case 15:return n=e.sent,e.next=18,n.json();case 18:a=e.sent,v(a),console.log(a),Oe(a),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),console.error("\u041e\u0448\u0438\u0431\u043a\u0430:",e.t0);case 27:case"end":return e.stop()}}),e,null,[[12,24]])})));return function(){return e.apply(this,arguments)}}(),Ee=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,o,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Getting image"),n=window.URL||window.webkitURL,(a=new FormData).append("token","TDlRJi8ORMGVrMedVkZDXsUDK"),a.append("action","extract_frame"),a.append("file_path",t.file_path),a.append("frame_index",t.frame_index),e.prev=7,e.next=10,fetch("https://9e94093f8750.sn.mynetname.net:5000/",{method:"POST",body:a});case 10:return r=e.sent,e.next=13,r.blob();case 13:return o=e.sent,c=n.createObjectURL(o),console.log("RESPONSE",o),e.abrupt("return",{metadata:t,image:c});case 19:e.prev=19,e.t0=e.catch(7),console.error("\u041e\u0448\u0438\u0431\u043a\u0430:",e.t0);case 22:case"end":return e.stop()}}),e,null,[[7,19]])})));return function(t){return e.apply(this,arguments)}}(),Oe=function(e){var t=Object.values(e[0].metadata);console.log(t);var n=Object(l.a)(t).sort((function(e,t){return e.distance-t.distance}));x(n),je(n),ve(n)},je=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.slice(t.length-V),a=t.slice(0,V),console.log("closest",n),console.log("farest",a),r=[],o=[],e.next=8,n.forEach((function(e){return Ee(e).then((function(e){return r.push(e)}))}));case 8:return e.next=10,a.forEach((function(e){return Ee(e).then((function(e){return o.push(e)}))}));case 10:I(r),z(o),setTimeout((function(){return X(!1)}),2e3);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(e){var t=Object(D.f)("%U"),n=Object(D.f)("%Y-%m-%d"),a=e,r=Object(D.a)(a,(function(e){return t(Date.parse(e.appearance_time))}));console.log("Time extent",r);var o=Object(D.b)(r[0],r[1]).concat(r[1]);console.log(o);var c=Object(N.a)().key((function(e){return t(Date.parse(e.appearance_time))})).rollup((function(e){return Object(D.d)(e,(function(e){return 1}))})).map(a);console.log("NESTED",c);var l=Object(N.a)().key((function(e){return n(Date.parse(e.appearance_time))})).rollup((function(e){return Object(D.d)(e,(function(e){return 1}))})).map(a);console.log("HOUR NEST",l);var i=Object(D.a)(l.keys());console.log(i);var s=Object(D.e)(new Date(i[0]),new Date(i[1])).map((function(e){return n(e)})),u=o.map((function(e){return(e<10?c.get("0"+e):c.get(e))||0})),m=s.map((function(e){return l.get(e)||0})),d=l.get(s[0]);console.log(s[3]),console.log("TEST",d),console.log(u),console.log(m),ee(m),re(s)};return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:e.spinner},W?r.a.createElement(R.a,{size:32,style:{color:"grey"}}):null),r.a.createElement(h.a,{container:!0,direction:"column",alignItems:"center",justify:"center"},r.a.createElement(h.a,{container:!0,justify:"center",className:e.gridItem},r.a.createElement(f,{handleChange:function(e){console.log(e),g(e)},handleClick:function(){be(!0)}})),r.a.createElement(h.a,{container:!0,justify:"center",className:e.gridItem},r.a.createElement(b,{handleChange:function(e){c(e.target.value)},value:o})),r.a.createElement(h.a,{container:!0,justify:"center",className:e.gridItem},r.a.createElement(E.a,{id:"radius",size:"small",label:"Radius",value:me,onChange:function(e){de(e.target.value)}}),r.a.createElement("button",{onClick:function(){return he()}},"Send Data")),r.a.createElement(h.a,{container:!0,justify:"center",className:e.gridItem},r.a.createElement("button",{onClick:function(){Z(!P)}},"Show Images")),r.a.createElement(h.a,{container:!0,justify:"center",className:e.gridItem},r.a.createElement("button",{onClick:function(){ie(!le)}},"Show Charts")),P?r.a.createElement(C,{farest:A,closest:_,quantity:V}):null),le?r.a.createElement(y,{timeRange:ae,dates:Q}):null,r.a.createElement(M,{handleClose:function(e,t){"clickaway"!==t&&be(!1)},open:ge}),r.a.createElement("button",{onClick:function(){return console.log(Object(D.c)().domain())}},"SCALE TIME TEST"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[349,1,2]]]);
//# sourceMappingURL=main.54786d20.chunk.js.map